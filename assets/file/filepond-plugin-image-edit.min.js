/*
 * FilePondPluginImageEdit 1.0.1
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */

/* eslint-disable */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.FilePondPluginImageEdit=e()}(this,function(){"use strict";var c=function(t){return/^image/.test(t.type)},t=function(t){var e=t.addFilter,i=t.utils,n=t.views,o=i.Type,E=i.createRoute,I=n.fileActionButton;e("SHOULD_REMOVE_ON_REVERT",function(t,e){var i=e.item,n=e.query;return new Promise(function(t){var e=i.file;t(!(n("GET_ALLOW_IMAGE_PREVIEW")&&n("GET_ALLOW_IMAGE_EDIT")&&n("GET_IMAGE_EDIT_ALLOW_EDIT")&&c(e)))})}),e("DID_LOAD_ITEM",function(n,t){var o=t.query,d=t.dispatch;return new Promise(function(t,e){var i=n.file;if(o("GET_ALLOW_IMAGE_PREVIEW")&&o("GET_ALLOW_IMAGE_EDIT")&&o("GET_IMAGE_EDIT_INSTANT_EDIT"))if(c(i)){var a=function(){if(l.length){var e,i,n,t=l[0],o=t.item,E=t.resolve,r=t.reject;d("EDIT_ITEM",{id:o.id,handleEditorResponse:(e=o,i=E,n=r,function(t){l.shift(),t?i(e):n(e),d("KICK"),a()})})}};r({item:n,resolve:t,reject:e}),1===l.length&&a()}else t(n);else t(n)})});var l=[],r=function(t){return l.push(t),t};return e("CREATE_VIEW",function(t){var e=t.is,a=t.view,d=t.query;if(e("file")&&d("GET_ALLOW_IMAGE_PREVIEW")&&d("GET_ALLOW_IMAGE_EDIT")){var l=d("GET_IMAGE_EDIT_EDITOR");if(l){l.outputData=!0,l.outputFile=!1,l.cropAspectRatio=d("GET_IMAGE_CROP_ASPECT_RATIO")||l.cropAspectRatio;a.registerDestroyer(function(t){var e=t.root;e.ref.buttonEditItem&&e.ref.buttonEditItem.off("click",e.ref.handleEdit)}),a.registerWriter(E({DID_IMAGE_PREVIEW_SHOW:function(t){var e=t.root;e.ref.buttonEditItem&&(e.ref.buttonEditItem.opacity=1)},DID_LOAD_ITEM:function(t){var e=t.root,i=t.props;if(d("GET_IMAGE_EDIT_ALLOW_EDIT")){var n=i.id,o=d("GET_ITEM",n);if(o){var E=o.file;if(c(E)){var r=a.createChildView(I,{label:"edit",icon:d("GET_IMAGE_EDIT_ICON_EDIT"),opacity:0});r.element.classList.add("filepond--action-edit-item"),r.element.dataset.align=d("GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION"),e.ref.handleEdit=function(){return e.dispatch("EDIT_ITEM",{id:n})},r.on("click",e.ref.handleEdit),e.ref.buttonEditItem=a.appendChildView(r)}}}},EDIT_ITEM:function(t){var e=t.root,i=t.props,n=t.action,o=i.id,E=n.handleEditorResponse,r=e.query("GET_ITEM",o);if(r){var a=r.file,d={crop:r.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null}};l.onconfirm=function(t){var e=t.data.crop;r.setMetadata({crop:e}),E&&(l.onclose=function(){E(!0),l.onclose=null})},l.oncancel=function(){E&&(l.onclose=function(){E(!1),l.onclose=null})},l.open(a,d)}}}))}}}),{options:{allowImageEdit:[!0,o.BOOLEAN],styleImageEditButtonEditItemPosition:["bottom center",o.STRING],imageEditInstantEdit:[!1,o.BOOLEAN],imageEditAllowEdit:[!0,o.BOOLEAN],imageEditIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',o.STRING],imageEditEditor:[null,o.OBJECT]}}};return"undefined"!=typeof window&&void 0!==window.document&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t});